# ì•ˆë“œë¡œì´ë“œ ìŠ¤íŠœë””ì˜¤ APK ë¹Œë“œ ì™„ë£Œ ì²´í¬ë¦¬ìŠ¤íŠ¸

## âœ… ì™„ë£Œëœ ì•ˆë“œë¡œì´ë“œ ë„¤ì´í‹°ë¸Œ ì„¤ì •

### 1. MainActivity.java âœ…
- ì»¤ìŠ¤í…€ URL ìŠ¤í‚´ (`walkstory://oauth`) ì²˜ë¦¬ ì™„ë£Œ
- `onNewIntent` ì˜¤ë²„ë¼ì´ë“œí•˜ì—¬ ì•± ì‹¤í–‰ ì¤‘ì—ë„ URL ì²˜ë¦¬
- Bridge ì¤€ë¹„ ëŒ€ê¸° ë¡œì§ ì¶”ê°€
- JavaScriptë¡œ URL ì•ˆì „í•˜ê²Œ ì „ë‹¬

### 2. AndroidManifest.xml âœ…
- ì»¤ìŠ¤í…€ URL ìŠ¤í‚´ intent-filter ì¶”ê°€ ì™„ë£Œ
- ì¸í„°ë„· ê¶Œí•œ ì„¤ì • ì™„ë£Œ
- ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ ì„¤ì • ì™„ë£Œ

### 3. ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ ì„¤ì • âœ…
- `network_security_config.xml` ì„¤ì • ì™„ë£Œ
- Vercel ë„ë©”ì¸ í—ˆìš© ì™„ë£Œ

### 4. í”„ë¡ íŠ¸ì—”ë“œ ë¡œì§ âœ…
- `window.handleOAuthCallback` í•¨ìˆ˜ êµ¬í˜„ ì™„ë£Œ
- Capacitor App í”ŒëŸ¬ê·¸ì¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì • ì™„ë£Œ

## ğŸš€ ì•ˆë“œë¡œì´ë“œ ìŠ¤íŠœë””ì˜¤ì—ì„œ ë¹Œë“œí•˜ê¸°

### 1ë‹¨ê³„: ì›¹ íŒŒì¼ ì¤€ë¹„

```bash
npm run prepare-android
```

ë˜ëŠ”:

```bash
node scripts/prepare-www.js
```

### 2ë‹¨ê³„: Capacitor ë™ê¸°í™”

```bash
npm run cap sync android
```

ë˜ëŠ”:

```bash
npx cap sync android
```

### 3ë‹¨ê³„: ì•ˆë“œë¡œì´ë“œ ìŠ¤íŠœë””ì˜¤ì—ì„œ ë¹Œë“œ

**ë°©ë²• A: Gradle ëª…ë ¹ì–´ ì‚¬ìš© (ê¶Œì¥)**

```bash
cd android
.\gradlew assembleDebug
```

ë¹Œë“œëœ APK:
```
android/app/build/outputs/apk/debug/WalkStory-debug.apk
```

**ë°©ë²• B: ì•ˆë“œë¡œì´ë“œ ìŠ¤íŠœë””ì˜¤ GUI**

1. ì•ˆë“œë¡œì´ë“œ ìŠ¤íŠœë””ì˜¤ì—ì„œ `android` í´ë” ì—´ê¸°
2. ìƒë‹¨ ë©”ë‰´: **Build** â†’ **Build Bundle(s) / APK(s)** â†’ **Build APK(s)**
3. ë¹Œë“œ ì™„ë£Œ í›„ **locate** í´ë¦­í•˜ì—¬ APK ìœ„ì¹˜ í™•ì¸

**ë°©ë²• C: Gradle ì‚¬ì´ë“œë°” ì‚¬ìš©**

1. ì•ˆë“œë¡œì´ë“œ ìŠ¤íŠœë””ì˜¤ ì˜¤ë¥¸ìª½ **Gradle** íƒ­ í´ë¦­
2. `android` â†’ `Tasks` â†’ `build` â†’ `assembleDebug` ë”ë¸”í´ë¦­

## ğŸ“ ë¹Œë“œ ì „ í•„ìˆ˜ í™•ì¸

- [ ] `npm run prepare-android` ì‹¤í–‰ ì™„ë£Œ
- [ ] `npm run cap sync android` ì‹¤í–‰ ì™„ë£Œ
- [ ] `android/local.properties` íŒŒì¼ ì¡´ì¬ (SDK ê²½ë¡œ ì„¤ì •)
- [ ] ì•ˆë“œë¡œì´ë“œ SDK ì„¤ì¹˜ í™•ì¸

## ğŸ”§ ë¹Œë“œ ì˜¤ë¥˜ í•´ê²°

### ì˜¤ë¥˜: "SDK location not found"

**í•´ê²°:**
`android/local.properties` íŒŒì¼ ìƒì„±:
```properties
sdk.dir=C\:\\Users\\User\\AppData\\Local\\Android\\Sdk
```
(ì‹¤ì œ SDK ê²½ë¡œë¡œ ë³€ê²½)

### ì˜¤ë¥˜: "Failed to resolve: capacitor-android"

**í•´ê²°:**
```bash
cd android
.\gradlew clean
cd ..
npm run cap sync android
```

### ì˜¤ë¥˜: "Manifest merger failed"

**í•´ê²°:**
- `AndroidManifest.xml` í™•ì¸
- ì¤‘ë³µëœ ê¶Œí•œ ì œê±°
- íŒ¨í‚¤ì§€ ì´ë¦„ í™•ì¸: `com.walkstory.app`

## ğŸ“¦ APK ì„¤ì¹˜

### USB ë””ë²„ê¹…ìœ¼ë¡œ ì„¤ì¹˜

```bash
adb install android/app/build/outputs/apk/debug/WalkStory-debug.apk
```

### ì§ì ‘ ì „ì†¡

1. APK íŒŒì¼ì„ ì•ˆë“œë¡œì´ë“œ ê¸°ê¸°ë¡œ ì „ì†¡
2. íŒŒì¼ ê´€ë¦¬ìë¡œ APK ì—´ê¸°
3. **ì•Œ ìˆ˜ ì—†ëŠ” ì¶œì²˜** í—ˆìš© (í•„ìš”ì‹œ)
4. ì„¤ì¹˜ ì§„í–‰

## âš ï¸ ì¤‘ìš” ì‚¬í•­

1. **ì¹´ì¹´ì˜¤ ê°œë°œì ì½˜ì†” ì„¤ì • í•„ìˆ˜**
   - ë„¤ì´í‹°ë¸Œ ì•±í‚¤: Android í”Œë«í¼ ë“±ë¡ (`com.walkstory.app`, í‚¤ í•´ì‹œ)
   - ë¦¬ë‹¤ì´ë ‰íŠ¸ URI: `https://walkinggrowth-app.vercel.app/api/auth/kakao-callback`

2. **ë””ë²„ê·¸ vs ë¦´ë¦¬ì¦ˆ**
   - ë””ë²„ê·¸ APK: í…ŒìŠ¤íŠ¸ìš© (`assembleDebug`)
   - ë¦´ë¦¬ì¦ˆ APK: ë°°í¬ìš© (`assembleRelease`) - ì„œëª… í‚¤ í•„ìš”

3. **ë¹Œë“œ í›„ í™•ì¸**
   - APK íŒŒì¼ì´ ìƒì„±ë˜ì—ˆëŠ”ì§€ í™•ì¸
   - íŒŒì¼ í¬ê¸°ê°€ 0ì´ ì•„ë‹Œì§€ í™•ì¸
   - ì„¤ì¹˜ í›„ ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸

## ğŸ¯ ë¹ ë¥¸ ë¹Œë“œ ëª…ë ¹ì–´

```bash
# ì „ì²´ í”„ë¡œì„¸ìŠ¤ (ì›¹ ì¤€ë¹„ + ë™ê¸°í™” + ë¹Œë“œ)
npm run prepare-android && npm run cap sync android && cd android && .\gradlew assembleDebug
```

ë˜ëŠ” ë‹¨ê³„ë³„:

```bash
# 1. ì›¹ íŒŒì¼ ì¤€ë¹„
npm run prepare-android

# 2. Capacitor ë™ê¸°í™”
npm run cap sync android

# 3. APK ë¹Œë“œ
cd android
.\gradlew assembleDebug
```

## ğŸ’¡ íŒ

- **ë¹ ë¥¸ ì¬ë¹Œë“œ**: `.\gradlew clean assembleDebug`
- **ë¹Œë“œ ìºì‹œ ì‚­ì œ**: `.\gradlew clean`
- **ì•ˆë“œë¡œì´ë“œ ìŠ¤íŠœë””ì˜¤ì—ì„œ ì—´ê¸°**: `npm run cap:android`
